---
chapter_no: 2
chapter_title: データの読み取り
created: 2021-08-31
updated: 2021-08-31
---
```
{em:comment{' DBを取得}em}
Dim p_db As DAO.Database
Set p_db = CurrentDb()

{em:comment{' SQLを実行}em}
Dim p_rs As DAO.Recordset
Set p_rs = p_db.OpenRecordset({em{<SQL文 or テーブル名 or クエリ名>}em}, RecordsetTypeEnum.dbOpenSnapshot)
With p_rs
    If .EOF Or .BOF Then
        {em:comment{' データがなかった時の処理}em}
        {em:comment{'   :}em}
        {em:comment{'   :}em}
        GoTo Finally
    Else
        {em:comment{' データがあった時の処理}em}
        .MoveFirst
        Do Until p_rs.EOF
            Debug.Print p_rs.Fields!ID
            Debug.Print p_rs.Fields("Name")
            Debug.Print p_rs.Fields("Age")
            Debug.Print p_rs.Fields("BillingAmount")
            p_rs.MoveNext
        Loop
    End If
End With

Finally:
{em:comment{' クローズ処理}em}
p_db.Close
Set p_db = Nothing
```

### ポイント
- `DAO.Databaset`というのがデータベースオブジェクトです。
  - `ADO`で言うところのコネクションのようなものです。
- `DAO.Recordset`がクエリを実行した結果オブジェクトです。
