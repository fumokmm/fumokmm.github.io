---
chapter_no: 2
chapter_title: 行番号の差分
created: 2021-08-18
updated: 2021-08-18
---
行番号の差分を利用する方法です。

### 考え方
- `ROW()`関数を利用すると、そのセルの行番号が取得できます。
  - `ROW()`と引数を省略した場合は、その数式があるセルの行番号が取得されます。
  - `ROW(<アドレス>)`とした場合、指定した`<アドレス>`の行番号が取得されます。
- `<現在の行番号>` - `<ヘッダの行番号>` とすることで、その行の行番号を取得する数式とします。
- `<ヘッダの行番号>`は行方向を`$`で固定しておきます。
  - 固定しておかないと、下に数式をコピーしたときにヘッダの行がずれていってしまいます。

### 数式
```syntax
= ROW() - ROW(<ヘッダのセル(行固定)>)
```

### 動作イメージ
<p class="center" markdown="span">
![](https://cdn-ak.f.st-hatena.com/images/fotolife/f/fumokmm/20210818/20210818195818.png)
</p>
