---
chapter_no: 15
chapter_group: 基礎文法
chapter_title: スコープ
created: 2021-05-16
updated: 2021-05-28
---
- PowerShellはダイナミックスコープを採用しています。
- スコープを生成するものは、以下の3種類。
  - 関数の実行
  - スクリプト ブロックの実行
  - スクリプト ファイルの実行
- 以下のようなものはスコープを生成しません。
  - `if` や `for` といった制御構文
  - `try` - `catch` - `finally`
  - `begin` - `process` - `end`

### 明示的なスコープの読み取り
- スコープの種類は、`global`、`script`、`local`、`private`の4種類あります。
- スコープ修飾子を指定しなかった場合は`local`となります。
```
{em{$global}em}:x = 10
{em{$script}em}:x = 20
{em{$local}em}:x = 30
```
- `global`はコンソール上でのスコープです。(一番外側)
- `script`はスクリプト内(.ps1)でのスコープです。
- `local`はスコープのところで書いた*スコープが生成される範囲内`でのスコープです。
- `private`だけちょっと毛色が違っていて、宣言したスコープよりも子のスコープから見えなくなるものです。

- スコープについては詳しくは[こちら](https://tech.blog.aerie.jp/entry/powershell-advent-calendar-2018-18)がとても参考になります。
