---
chapter_no: 23
chapter_group: 関数
chapter_title: 値渡し、参照渡し
created: 2021-07-20
updated: 2021-07-20
---
- 値渡しは通常の操作です。関数の中で書き換えても呼び出し元の方の変数へは影響が及びません。
- 参照渡しをするには、変数にを`ref型`に変換(`[ref]`を付ける)して渡します。
  - 以下の例では、受け取る引数の方も`[ref]`を付けていますが、これは必須ではありません(省略可)。
  - ただ、明示的に`[ref]`を付けておいたほうが、参照渡しであることが分かりやすいので、付けておいたほうがいいかもしれません。

```:function_args_byval_byref.ps1
{em:comment{# 値渡し}em}
function byVal($arg) {
    $arg = 'Good bye!'
    Write-Host "in function(byVal): $arg"
}

{em:comment{# 参照渡し}em}
function byRef({em:blue{[ref]}em}$arg) {
    $arg{em{.Value}em} = 'Good bye!'
    Write-Host "in function(byRef): $($arg.Value)"
}
function byRef2($arg) {
    $arg{em{.Value}em} += '!!'
    Write-Host "in function(byRef2): $($arg.Value)"
}

$str = 'Hello'
$str
byVal $str  {em:comment{# 値渡し}em}
$str  {em:comment{# => Hello のまま}em}

byRef({em:blue{[ref]}em}$str)　{em:comment{# 参照渡し}em}
$str  {em:comment{# => Good bye! に書き換わっている}em}
byRef2({em:blue{[ref]}em}$str)　{em:comment{# 参照渡し}em}
$str  {em:comment{# => Good bye!!! に書き換わっている}em}
```

```output:出力結果
{em:command{PS C:\temp>}em} .\function_args_byval_byref.ps1
Hello
in function(byVal): Good bye!
Hello
in function(byRef): Good bye!
Good bye!
in function(byRef2): Good bye!!!
Good bye!!!
```
