---
chapter_no: 3
chapter_title: コネクション取得
created: 2021-10-24
updated: 2021-10-24
---
コネクションは`pyodbc.connect()`で取得します。  
ここでは参考に`SQL Server`を使った例を紹介します。
```
import pyodbc

{em:comment{# ODBCドライバ, サーバ名, データベース名, ユーザID, パスワードなどを指定します}em}
cnxn = pyodbc.{em{connect(}em}'DRIVER={em:blue{{SQL Server}}em};SERVER={em:blue{localhost}em};DATABASE={em:blue{testdb}em};UID={em:blue{me}em};PWD={em:blue{pass}em}'{em{)}em}
{em:comment{# DNSを使う場合はこんな感じ}em}
cnxn = pyodbc.{em{connect(}em}'DSN={em:blue{test}em};PWD={em:blue{password}em}'{em{)}em}

{em:comment{コネクションからカーソルを作成します}em}
cursor = cnxn.cursor()
```
- まず、`pyodbc`の`connect()`を使ってODBCドライバ, サーバ名, データベース名, ユーザID, パスワードなどを指定しコネクションを取得します。
- 次に、コネクションから`cursor()`を使ってカーソルを取得します。
- カーソルはSQLクエリを実行するときに利用するものです。

### SQLクエリの実行
SQLクエリを実行するには、カーソルの`execute()`を使います。  
```
cursor.execute({em{"<SQLクエリ>"}em})
```