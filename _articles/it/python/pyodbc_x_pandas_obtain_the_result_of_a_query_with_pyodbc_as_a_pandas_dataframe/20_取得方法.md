---
chapter_no: 20
chapter_title: 取得方法
created: 2022-03-23
updated: 2022-03-23
---
```
import pyodbc
import pandas
import csv

conn = pyodbc.connect("<接続文字列>")
conn.autocommit = False
cursor = conn.cursor()
result = cursor.execute("<SQL>")
desc = result.description
{em:orange{column_names}em} = [d[0] for d in desc] {em:comment{# 取得結果の列名を取得}em}
{em{rows}em} = cursor.fetchall() {em:comment{# データを取得}em}
cursor.close()

{em:comment{# pyodbcの取得結果=rows}em}
{em:comment{# rowsをpandasのDataFrameへ}em}
{em:comment{# ついでにcolumn_namesとして列名のリストも取得し列として指定}em}
df = {em:blue{pandas.DataFrame(numpy.array(}em}{em{rows}em}{em:blue{)}em}, columns={em:orange{column_names}em}, index=None)

{em:comment{# CSVへ出力}em}
df.to_csv("<出力先パス>", sep=",", encoding="UTF-8", index=False, mode="w", quoting=csv.QUOTE_ALL)
```
- `pyodbc`の取得結果は`rows`という変数に入れています。
- この`rows`を`pandas.DataFrame()`へ、`numpy.array()`にして指定します。
  - `DataFrame`は`df`という変数に入れています。
- 上記は、CSVとして出力するサンプルなので、`pyodbc`の取得結果の`description`から列名を取得し、`column_names`という変数に入れています。
  - `DataFrame`を作る際に、この列名も`columns=`で指定しています。
