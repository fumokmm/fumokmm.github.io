---
chapter_no: 5
chapter_title: テーブル変数の値を取得し他の変数に設定
created: 2021-09-10
updated: 2021-09-10
---
`テーブル変数`の値を取り出して、他の変数に設定することもできます。  
取得するSQLは`WHERE句`や`TOP(x)`で絞ったりして、データを一意にする必要があります。[^error-msg]

```syntax
SET {em{@変数名}em} = ({em:blue{<取得結果が一意になるSQL>}em})
```

### 例
```
SET {em{@last_id}em} = ({em:blue{SELECT TOP 1 id FROM @id_tables ORDER BY id DESC}em});
```

[^error-msg]: もし、複数の結果を返すSQLだと以下のようなエラーメッセージが出力されます。  
			  メッセージ 512、レベル 16、状態 1、行 14  
              サブクエリは複数の値を返しました。サブクエリが =、!=、<、<=、>、>= の後に続く場合や、サブクエリが 1 つの式として使われる場合は複数の値は許可されません。
